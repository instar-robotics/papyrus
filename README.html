<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-07-30 Tue 18:44 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Papyrus User Guide</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="nschoe" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Papyrus User Guide</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orga90b81c">1. Introduction</a></li>
<li><a href="#org2e4a923">2. How to install</a>
<ul>
<li><a href="#orgf5935f6">2.1. Dependencies</a></li>
<li><a href="#orgf604594">2.2. Fetching the sources and building</a></li>
<li><a href="#org6bd2d6f">2.3. Launching &amp; running</a></li>
</ul>
</li>
<li><a href="#org912260c">3. How to use</a>
<ul>
<li><a href="#orgd001dcf">3.1. First launch</a></li>
<li><a href="#org6ac26df">3.2. The main window</a>
<ul>
<li><a href="#orgb0f4297">3.2.1. 1. The tool bar</a></li>
<li><a href="#org94ea6ca">3.2.2. 2. The library panel</a></li>
<li><a href="#org484b14b">3.2.3. 3. The properties panel</a></li>
<li><a href="#org4bd0186">3.2.4. 4. The scene</a></li>
<li><a href="#orge4b38de">3.2.5. 5. The status bar</a></li>
<li><a href="#orgb984214">3.2.6. 6. The ROS-master indicator</a></li>
</ul>
</li>
<li><a href="#org5380a30">3.3. Manual</a>
<ul>
<li><a href="#org0bcf96f">3.3.1. Create a new script</a></li>
<li><a href="#org41bd4ba">3.3.2. Open an existing script</a></li>
<li><a href="#orgcd1247c">3.3.3. Save current script</a></li>
<li><a href="#org0ade04e">3.3.4. Close current script</a></li>
<li><a href="#org0c502e2">3.3.5. Undo / redo actions</a></li>
<li><a href="#org15c22ed">3.3.6. Reopen last opened scripts</a></li>
<li><a href="#org2f85593">3.3.7. Zooming the scene</a></li>
<li><a href="#org10421e6">3.3.8. Antialiasing</a></li>
<li><a href="#orgf49690c">3.3.9. Display the grid</a></li>
<li><a href="#org2d3aa7b">3.3.10. Connect to a running <code>Kheops</code> script</a></li>
<li><a href="#org8fe8ab9">3.3.11. Launch/pause/resume/stop a script</a></li>
<li><a href="#org648d556">3.3.12. Display a Function&rsquo;s activity</a></li>
<li><a href="#orga86efa1">3.3.13. Hiding / showing all outputs</a></li>
<li><a href="#orga8c00e2">3.3.14. Listing shortcuts</a></li>
<li><a href="#org7aeccdc">3.3.15. See the CHANGELOG</a></li>
<li><a href="#orgb9ea93a">3.3.16. See the About dialog</a></li>
<li><a href="#org00a47ce">3.3.17. Creating a Link</a></li>
<li><a href="#org27fc923">3.3.18. Inhibition Inputs</a></li>
<li><a href="#org5985a2d">3.3.19. Swapping Functions</a></li>
<li><a href="#org262e3f2">3.3.20. Creating comment zones</a></li>
<li><a href="#org9df38ce">3.3.21. Color code for types</a></li>
<li><a href="#org9364b89">3.3.22. Seeing the input names</a></li>
<li><a href="#orge9ed123">3.3.23. Icon reflects type and matrix size</a></li>
<li><a href="#orgfbe5a88">3.3.24. Name conventions</a></li>
<li><a href="#orgdb85d29">3.3.25. Function documentation</a></li>
<li><a href="#org94c04c5">3.3.26. Error indicators</a></li>
<li><a href="#orgf2ee239">3.3.27. Commenting / uncommenting Functions</a></li>
<li><a href="#org1dc2163">3.3.28. Copying / Pasting Functions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgebeb4f8">4. Troubleshooting</a>
<ul>
<li><a href="#orge0e2517">4.1. Network Setup</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="figure">
<p><img src="./papyrus-icon.png" alt="papyrus-icon.png" />
</p>
</div>

<p>
<i>(An HTML of this <code>README</code> is available <a href="./README.html">here</a> if you prefer)</i>
</p>

<div id="outline-container-orga90b81c" class="outline-2">
<h2 id="orga90b81c"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
<a href="https://github.com/instar-robotics/papyrus">Papyrus</a> is <a href="https://github.com/instar-robotics/kheops">Kheops</a>&rsquo;s GUI program to create, edit and debug neural network to produce Artificial
Intelligence robotics behaviors.
</p>

<p>
Here&rsquo;s a (non-exhaustive) list of features <code>Papyrus</code> offer:
</p>
<ul class="org-ul">
<li>It allows you to create complex, neural-network based artificial intelligence robotic behaviors
easily.</li>
<li>It allows you to do so <i>without any programming required</i>: <a href="https://github.com/instar-robotics/alexandria">Alexandria</a> is a library of function
that we have developed ; in order to create a <i>neural script</i> all that is needed is to drag and
drop some functions, and link them together.</li>
<li>It allows you to interactively launch, pause, stop and restart scripts (which are run with <a href="https://github.com/instar-robotics/kheops">Kheops</a>)
all from the <code>Papyrus</code> GUI.</li>
<li>It allows you to <i>connect</i> to a running <code>Kheops</code> script and administer it in the same way.</li>
<li>It provides <i>live visualization</i> of any function&rsquo;s output, right into the GUI: the script is
running with <code>kheops</code> at its own rate, <code>papyrus</code> allows you to look at the output values in real
time, without the need to stop and relaunch <code>kheops</code> ; it&rsquo;s all done <i>live</i> (which is very
convenient as sometimes you notice your robot is doing something funny and if you had to
stop-and-restart in order to enable live visualization, the funny behavior would certainly go
away!).</li>
</ul>
</div>
</div>

<div id="outline-container-org2e4a923" class="outline-2">
<h2 id="org2e4a923"><span class="section-number-2">2</span> How to install</h2>
<div class="outline-text-2" id="text-2">
<p>
The suite (<code>Papyrus</code>, <a href="https://github.com/instar-robotics/kheops">Kheops</a>, <a href="https://github.com/instar-robotics/alexandria">Alexandria</a> and <a href="https://github.com/instar-robotics/hieroglyph">Hieroglyph</a>) are based on ROS:
</p>
<ul class="org-ul">
<li>scripts communicate with one another through ROS topics</li>
<li>live visualization is achieved by having functions publish their outputs in a ROS topic</li>
<li>ROS services are used to control scripts from the GUI</li>
</ul>

<p>
<code>Papyrus</code>&rsquo;s GUI is based on Qt 5.
</p>

<p>
As an indicator, <code>Papyrus</code> was successfully compiled and run on Ubuntu 18.04, and nixOS (starting
from 18.09, though it needs some adjustments for the ROS packages).
</p>

<p>
<code>Papyrus</code> and <code>Kheops</code> are fully independent one from each other (and it&rsquo;s important to keep it that
way) which allows us to have <code>Kheops</code> only installed on robot (especially if those robots have a
non-graphical installation) and <code>Papyrus</code> installed on the diagnostic / development machines.
</p>
</div>

<div id="outline-container-orgf5935f6" class="outline-3">
<h3 id="orgf5935f6"><span class="section-number-3">2.1</span> Dependencies</h3>
<div class="outline-text-3" id="text-2-1">
<p>
In order to build and run <code>Papyrus</code>, you will need those dependencies:
</p>
<ul class="org-ul">
<li>System:
<ul class="org-ul">
<li><a href="https://www.qt.io/"><code>Qt5</code></a> (<code>&gt;=5.10</code>) and the following Qt modules (or the fully Qt installation if you prefer):
<ul class="org-ul">
<li><code>Qt5::Widgets</code></li>
<li><code>Qt5::Svg</code></li>
</ul></li>
<li><a href="https://cmake.org/"><code>CMake</code></a> (<code>&gt;=3.1.0</code>)</li>
<li><a href="https://www.cryptopp.com/"><code>crypto++</code></a> (<code>&gt;=5.6.5</code>)</li>
<li><a href="https://www.gnu.org/software/bc/"><code>bc</code></a></li>
</ul></li>
<li>ROS:
<ul class="org-ul">
<li><a href="https://wiki.ros.org/Documentation">ROS</a> (at least <code>lunar</code>, but we recommend using <code>melodic</code> if you can)</li>
<li><a href="https://wiki.ros.org/roscpp"><code>roscpp</code></a></li>
<li><a href="https://wiki.ros.org/std_msgs">=std<sub>msgs</sub></a></li>
</ul></li>
<li>Suite (we recommend to put them in the same catkin workspace):
<ul class="org-ul">
<li><a href="http://github.com/instar-robotics/hieroglyph">=hieroglyph</a></li>
<li><a href="http://github.com/instar-robotics/alexandria"><code>alexandria</code></a></li>
</ul></li>
</ul>

<p>
For the system and ROS dependencies, we let the user install the packages using his linux
distribution specifics.
</p>

<p>
Below we explain how to build the dependencies from our suite (namely <code>Papyrus</code>, <code>Alexandria</code> and <code>Hieroglyph</code>).
</p>
</div>
</div>

<div id="outline-container-orgf604594" class="outline-3">
<h3 id="orgf604594"><span class="section-number-3">2.2</span> Fetching the sources and building</h3>
<div class="outline-text-3" id="text-2-2">
<p>
<i><b>Note</b>: we assume the user has sourced the ROS <code>setup.bash</code> (typically <code>source
/opt/ros/&lt;distro&gt;/setup.bash</code>) before issuing the following commands.</i>
</p>
<ul class="org-ul">
<li>First we have to create a <code>catkin</code> workspace:</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$&gt; mkdir -p ~/workspace/catkin_ws/src
$&gt; cd ~/workspace/catkin_ws/src
$&gt; catkin_init_workspace
</pre>
</div>

<p>
This effectively makes =~/workspace/catkin<sub>ws</sub>/` a <i>catkin workspace</i> and this is where we will run
the commands necessary to build (and install if you want) your catkin packages. We made all our
software components (<code>Papyrus</code>, <code>Kheops</code>, <code>Alexandria</code> and <code>Hieroglyph</code>) catkin packages, so you can
add all of them in the same catkin workspace for a smooth and painless compilation.
</p>

<p>
The above commands should result in a <code>CMakeLists.txt</code> symlink in <code>~/workspace/catkin_ws/src</code>.
</p>

<ul class="org-ul">
<li>Then we build the (empty) workspace:</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$&gt; cd ~/workspace/catkin_ws
$&gt; catkin_make
</pre>
</div>

<p>
This should produce two new directories next to <code>src/</code>, which are: <code>build/</code> and <code>devel/</code>.
</p>

<ul class="org-ul">
<li>Then we source our catkin worspace-specific <code>setup.bash</code>:</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$&gt; source ~/workspace/catkin_ws/devel/setup.bash
</pre>
</div>

<p>
This <b>must</b> be done every time you want to work with <code>Papyrus</code> (the same way you should always
source your global ROS <code>setup.bash</code>). If you tend to open and close a lot of terminals, you might
want to add those two <code>source</code> commands in your <code>~/.bashrc</code>.
</p>

<ul class="org-ul">
<li>Then we fetch the sources:</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$&gt; cd ~/workspace/catkin_ws/src
$&gt; git clone https://github.com/instar-robotics/papyrus.git
$&gt; git clone https://github.com/instar-robotics/alexandria.git
$&gt; git clone https://github.com/instar-robotics/hieroglyph.git
</pre>
</div>

<p>
Make sure you cloned the three repositories in the <code>src/</code> directory and not at the root of the
catkin workspace (catkin expects projects to be in <code>src/</code>).
</p>

<ul class="org-ul">
<li>Then we build the whole workspace:</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$&gt; cd ~/workspace/catkin_ws/
$&gt; catkin_make
</pre>
</div>

<p>
<b>notes:</b>
</p>
<ul class="org-ul">
<li>make sure you are at the <b>root</b> of the catkin workspace and <b>not</b> in the <code>src/</code> or any
subdirectory: catkin will crash and tell you it cannot find projects. <code>catkin</code> commands are issued
at the root of the catkin workspace.</li>
<li>when running <code>catkin_make</code> alone, it generally try to use all your cores for building, so you
might want to adjust with <i>e.g.</i> <code>catkin_make -j2</code> if you want to restrict to two cores.</li>
<li>when running <code>catkin_make</code> alone, it scans your entire catkin workspace and rebuild all projects
inside, that were modified. If you are working on one project (<i>e.g.</i> <code>Papyrus</code>) only, you can
speed up and ask catkin to build only this project by passing <code>--pkg &lt;project-name&gt;</code>.
So you can use <code>catkin_make --pkg papyrus</code>.</li>
<li>if you make modifications and you add or remove files (typical example if when you ad a new
class), you need to regenerate the CMake files, for this, pass <code>--force-cmake</code>, like this:
<code>catkin_make --pkg papyrus --force-cmake</code>.
But you don&rsquo;t have to worry about this if you are only using <code>Papyrus</code> and not modifying it.</li>
</ul>
</div>
</div>

<div id="outline-container-org6bd2d6f" class="outline-3">
<h3 id="org6bd2d6f"><span class="section-number-3">2.3</span> Launching &amp; running</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Being a ROS package, you can launch <code>Papyrus</code> from anywhere (you don&rsquo;t need to be in your catkin
workspace, as long as you sourced your <code>~/workspace/catkin_ws/devel/setup.bash</code>) with the following
<code>rosrun</code> command:
</p>

<div class="org-src-container">
<pre class="src src-sh">$&gt; rosrun papyrus papyrus
</pre>
</div>

<p>
<b>note:</b> you need to write <code>papyrus</code> twice: the first one is the name of the ROS package, and the
second is the executable to launch from this package. It is possible to have several executables
inside a ROS package.
A good indicator that you have correctly sourced your catkin workspace <code>setup.bash</code> is that typing
<code>rosrus pa</code> and using <code>&lt;TAB&gt;</code> should auto complete it to <code>papyrus</code>, if it doesn&rsquo;t it <i>generally</i>
means there&rsquo;s an issue (or you are running an exotic system!).
</p>

<p>
Alternatively, the executable is store in <code>~/workspace/catkin_ws/devel/lib/</code> and is called simply
<code>papyrus</code>. So you can also launch it directly from there.
</p>

<p>
If everything went well, you should have something like this:
</p>


<div id="org047ee1d" class="figure">
<p><img src="./papyrus-preview.png" alt="papyrus-preview.png" />
</p>
<p><span class="figure-number">Figure 2: </span>Papyrus home page</p>
</div>

<p>
Congrats! <code>Papyrus</code> is now build and installed!
</p>
</div>
</div>
</div>

<div id="outline-container-org912260c" class="outline-2">
<h2 id="org912260c"><span class="section-number-2">3</span> How to use</h2>
<div class="outline-text-2" id="text-3">
<p>
Here&rsquo;s a quick tutorial on how to use <code>Papyrus</code>. We will try to keep this section updated as we
develop new features, but if you are a <code>Papyrus</code> user and you wrote a tutorial,
<a href="mailto:nicolas.schoemaeker@instar-robotics.com">shoot us an email</a> and we&rsquo;ll be glad to add a link to your tutorial!
</p>
</div>

<div id="outline-container-orgd001dcf" class="outline-3">
<h3 id="orgd001dcf"><span class="section-number-3">3.1</span> First launch</h3>
<div class="outline-text-3" id="text-3-1">
<p>
<code>Papyrus</code> needs to be given two path to work correctly. The first one is the path to the XML
description files. Basically it needs to know where it should go parse XML files that describes the
Functions to populate the library, Typically you&rsquo;d give it the path to where <code>Alexandria</code> is.
</p>

<p>
The second path it needs to have it the location of the C++ library files, that corresponds to the
library Functions, this is where <code>Alexandria</code> was compiled.
</p>

<p>
<code>Papyrus</code> has two modes builtin: <code>DEBUG</code> and <code>RELEASE</code>. Typically, <code>DEBUG</code> should rather be called
<code>DEV</code> (and it might be renamed later on), and this is intended to work on <code>Alexandria</code>: add new
Functions, change some, delete some, etc. While <code>RELEASE</code> is meant to work with a stable set of
library Functions.
</p>

<p>
The two path mentioned above must be given to <code>Papyrus</code> in both <code>RELEASE</code> and <code>DEBUG</code> mode, which
means <code>Papyrus</code> can ask you 4 paths. The first time your launch <code>Papyrus</code>, it will ask you to give
it the XML description path for the mode it is currently is (it&rsquo;s <code>RELEASE</code> by default). And the
first time you try to launch a <code>Kheops</code> script (by clicking the play button in the toolbar), it will
ask you the path for the libraries.
</p>

<p>
For now, as <code>Papyrus</code> is still quite new, I suggest you switch to the <code>DEBUG</code> mode (by clicking
<code>Options &gt; Development &gt; Debug</code> and then quit <code>Papyrus</code> with <code>CTRL + Q</code> and relaunch it).
When it asks you the description path for the <code>DEBUG</code> mode, you should set it to
<code>~/workspace/catkin_ws/devel/share/alexandria/descriptions</code> and when it asks you the path for the
libraries, you should set it to <code>~/workspace/catkin_ws/devel/lib/alexandria</code>.
</p>

<p>
If you messed up, or want to change it, click <code>Options &gt; Developemnt &gt; Edit paths</code> or manually
change the <code>debugLibPath</code>, <code>debugPath</code>, <code>releaseLibPath</code>, <code>releasePath</code> in <code>Papyrus</code>&rsquo;s config file
located at <code>~/.config/INSTAR Robotics/Papyrus.conf</code>.
</p>
</div>
</div>

<div id="outline-container-org6ac26df" class="outline-3">
<h3 id="org6ac26df"><span class="section-number-3">3.2</span> The main window</h3>
<div class="outline-text-3" id="text-3-2">
<p>
<code>Papyrus</code>&rsquo;s main GUI window is roughly divided into <b>6</b> areas, as shown here:
</p>


<div id="org9329bbe" class="figure">
<p><img src="./papyrus-gui-1.png" alt="papyrus-gui-1.png" />
</p>
<p><span class="figure-number">Figure 3: </span>The main window</p>
</div>

<p>
We&rsquo;ll describe the features of the areas briefly, before going into more details.
</p>
</div>

<div id="outline-container-orgb0f4297" class="outline-4">
<h4 id="orgb0f4297"><span class="section-number-4">3.2.1</span> 1. The tool bar</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
This is standard GUI toolbar like you expect. It provides quick access to commonly-used items in the
menu above.
Starting from the left, you have icons to:
</p>
<ul class="org-ul">
<li>Create a new script (<code>CTRL + N</code>)</li>
<li>Open an existing script (<code>CTRL + O</code>)</li>
<li>Save current script (<code>CTRL + S</code>)</li>
<li>Zoom in in the scene  (<code>CTRL + +</code>)</li>
<li>Zoom out in the scene (<code>CTRL + -</code>)</li>
<li>Zoom fit: zoom so that all Functions are within view (useful when you have &ldquo;lost&rdquo; a Function)
(<code>CTRL + =</code>)</li>
<li>Toggle display the grid (<code>CTRL + SHIFT + G</code>)</li>
<li>Connect to a running <code>Kheops</code> script (<code>CTRL + C</code>)</li>
<li>Play: launch or resume the current script
<ul class="org-ul">
<li>This button becomes a Pause button when the current script is running.</li>
</ul></li>
<li>Timer: display the uptime of the current script <i>(feature not yet implemented!)</i></li>
<li>Stop: stop the current script; the script will stop running and quit (the linux process will
disappear).</li>
<li>Oscilloscope: display the execution time of all Functions in the script, used to determine which
functions take the most time to execute <i>(feature not yet implemented!)</i></li>
</ul>

<p>
More might come as we ass new feature, make sure to come check this tutorial every now and then to
discover new ones.
</p>
</div>
</div>

<div id="outline-container-org94ea6ca" class="outline-4">
<h4 id="org94ea6ca"><span class="section-number-4">3.2.2</span> 2. The library panel</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
This library panel contains the current loaded Functions (in <code>Alexandria</code>). Those are all the
Functions you can add (by drag and dropping them) to the script.
The window is usually bigger, when the property panel (see below) is not big.
</p>

<p>
The blue entries (&ldquo;Constants&rdquo;, &ldquo;Arithmetic&rdquo;, &ldquo;Boolean&rdquo;, etc.) are <i>categories</i> and they are used to
group Functions into logical sections (which are separate library in C++ sense).
</p>

<p>
Double-click a category to expand/collapse it. Only one category can be expanded at a time (we have
several hundreds of functions, so it&rsquo;s to prevent things to get messy).
</p>

<p>
Note the <code>Filter...</code> field above: type something in it, and the Functions will be sorted on-the-fly,
allowing you to reach the desired function in a few keystrokes!
</p>

<p>
To add a Function into the script, simply drag it from this library panel and drop it to the scene
(see below).
</p>
</div>
</div>

<div id="outline-container-org484b14b" class="outline-4">
<h4 id="org484b14b"><span class="section-number-4">3.2.3</span> 3. The properties panel</h4>
<div class="outline-text-4" id="text-3-2-3">
<p>
This panel is used to display the properties of the currently-selected object in the scene (see
below). It changes dynamically based on what you select.
</p>

<p>
In the screenshot above, it shows the properties for the Function called <code>MSSum</code> that is in the
scene. The properties panel enables you to see and edits properties for three kinds of objects:
</p>
<ul class="org-ul">
<li>Functions</li>
<li>Links</li>
<li>Scripts</li>
</ul>

<p>
When you modify properties in this panel, changed are applied only when you click the <code>OK</code> button or
you press <code>&lt;ENTER&gt;</code>. If you exit the panel by clicking the scene or another object or if you hit
<code>Cancel</code> or press <code>ESCAPE</code>, the object&rsquo;s properties will be left untouched and the values in this
panel will be restored to the one the object currently has.
</p>

<p>
In the <a href="#org9329bbe">above screenshot</a> a Function&rsquo;s properties are displayed and can be modified:
</p>
<ul class="org-ul">
<li><code>Title</code>: is a pretty name you can give a Function. It is optional and defaults to an empty value.
When a Function has no <code>title</code>, it is shown as its Function name (here it is <code>MSSum</code>).
The Function&rsquo;s <code>name</code> is always displayed at the very top of the properties panel, in bold. In the
scene, a Function&rsquo;s <code>title</code> will be displayed if you gave one, the Function&rsquo;s <code>name</code> otherwise.
A Function&rsquo;s <code>name</code> is important to <code>Papyrus</code> and <code>Kheops</code> as it corresponds to the real C++ class
behind it (this is why you cannot modify it), whereas the Function&rsquo;s <code>title</code> has no meaning for
<code>Papyrus</code> and <code>Kheops</code>: it is merely for your convenience (and for the convenience of the people
who will be reading your script later on). We encourage giving Function&rsquo;s some meaningful =name=s
(like you would give variables or functions meaningful names in a programming language).</li>
<li><p>
<code>Type</code>: it is the output type of the Function, you cannot change it. It was determined by the
developer who created the Function. <code>Kheops</code> is strongly typed, so types matter. We have three
types:
</p>
<ul class="org-ul">
<li><code>STRING</code> is the least used and is meant to pass parameters (like a topic name when you want to</li>
</ul>
<p>
publish or subscribe to a topic, etc.).
</p>
<ul class="org-ul">
<li><code>SCALAR</code> is a single floating point value. It is a =<a href="https://docs.ros.org/melodic/api/std_msgs/html/msg/Float64.html">Float64=</a> ROS type.</li>
<li><code>MATRIX</code> is a matrix of floating point values. It is a <a href="https://docs.ros.org/melodic/api/std_msgs/html/msg/Float64MultiArray.html"><code>Float64MultiArray</code></a> ROS type.</li>
</ul></li>
<li><code>Shape</code>: indicates the requirement of dimensions for a <code>MATRIX</code> Function, and restrict what you
can give as dimensions for a Function. It can take five values:
<ul class="org-ul">
<li><code>SHAPE_NONE</code>: means there is no restriction: you can set whatever dimensions you want (this is
the most common)</li>
<li><code>POINT</code>: means your <code>MATRIX</code> Function must be of dimension <code>(1,1)</code>. in this case, you
cannot modify the dimensions: they are imposed and are both equal to <code>1</code>. This is rare and used
only for &ldquo;casting&rdquo; values. Since <code>Kheops</code> is strongly typed, a scalar (<code>SCALAR</code>) cannot be fed
into a Function&rsquo;s parameter which expects a matrix (<code>MATRIX</code>), even when it expect a
single-valued matrix (and vice-versa). For this purpose, we created Functions to cast a scalar
into a <code>(1,1)</code> matrix (and the opposite, too).</li>
<li><code>VECT</code>: means your <code>MATRIX</code> Function must be a vector, <i>i.e.</i> have at least one of its
dimension set to <code>1</code>, but we don&rsquo;t care which one.
With a <code>SHAPE_VECT</code> Function, if you set <code>rows</code> to a different value that <code>1</code>, <code>cols</code> will be
automatically set to <code>1</code> and vice-versa. Note that it is possible to set both to <code>1</code>.</li>
<li><code>ROW_VECT</code>: means your <code>MATRIX</code> Function must be a row vector, <i>i.e.</i> its <code>rows</code> dimension is
fixed and equal to <code>1</code>, and you can only set the number of <code>cols</code> (not that it can also be set
to <code>1</code>).</li>
<li><code>COL_VECT</code>: means your <code>MATRIX</code> Function must be a column vector, <i>i.e.</i> its <code>cols</code> dimension is
fixed and equal to <code>1</code>, and you can only set the number of <code>rows</code> (not that it can also be set
to <code>1</code>).</li>
</ul></li>
<li><code>Rows</code>: is the number of rows in your <code>MATRIX</code> (this doesn&rsquo;t appear for <code>SCALAR</code> Functions). It is
sometimes also called to <code>y</code>-dimension.
You can edit it, with the restrictions of the <code>Shape</code> field.</li>
<li><code>Cols</code>: is the number of columns in your <code>MATRIX</code> (this doesn&rsquo;t appear for <code>SCALAR</code> Functions). It is
sometimes also called to <code>x</code>-dimension.
You can edit it, with the restrictions of the <code>Shape</code> field.</li>
<li><code>Save Activity</code>: a Function&rsquo;s output is also called its <i>activity</i> (we use the terms
interchangeably in this tutorial). When checked, it means <code>Kheops</code> will save this Function&rsquo;s
output/activity <i>at every iteration of the script</i>. This can be an expensive step if your matrix
has big dimensions.
Activity is saved in a shared memory location. This is meant to be used for Functions which needs
to restart from their previous values when/if the <code>Kheops</code> script crashes (like Functions that
performs integration, etc.). If you don&rsquo;t <i>need</i> this, we recommend not to check this box.</li>
<li><code>Publish output</code>: when this is checked, it means the Function will publish its output/activity et
every iterations, in the ROS topic named just below. This is used when you have other scripts
(<code>Kheops</code> script or other) that need to use (<code>subscribe</code>) to this Function&rsquo;s output.
This is the way several <code>Kheops</code> scripts can communicate together.
<b><b>note:</b></b> check this box <b><b>only</b></b> to Functions whose output you <b>need</b> to use <i>in production</i> as
this value is saved in the script file.
<code>Papyrus</code> and <code>Kheops</code> provide a on-the-fly way to enable live data visualization for a given Function
<i>even when this Function does not publish!</i>. The TL;DR is: do not check this box if you only want
to debug this Function using <code>Papyrus</code> as it can do without it.</li>
<li><code>Topic</code>: this is the ROS topic name under which this Function should publish if you checked the
<code>Publish output</code> checkbox. Three possibilities for this field:
<ul class="org-ul">
<li>if you did not enter anything, the topic name defaults to <code>/kheops_&lt;script_name&gt;/function_&lt;uuid&gt;</code>
where:
<ul class="org-ul">
<li><code>&lt;script_name&gt;</code> is the script name</li>
<li><code>&lt;uuid&gt;</code> is the Function&rsquo;s unique identifier, with hyphens replaced by underscores</li>
</ul></li>
<li>if you enter a name with a leading slash <i>e.g.</i> <code>/my_topic</code> this will create this topic exactly
as is; you need to make sure you are not going to shadow another topic.</li>
<li>if you enter a name without a leading slash <i>e.g.</i> <code>my_topic</code> this will create a topic name
within the namespace of the ROS node.</li>
</ul></li>
<li><code>Display Visualization</code> is a button you can click to enable live visualization of a Function&rsquo;s
output/activity. You do <b>not</b> need to have the <code>Publish output</code> enabled for this.
Live visualization is a very powerful feature of <code>Papyrus</code> as it allows you to check the return
value of any Function, live, at it runs either on your machine or on a remote robot.</li>
</ul>

<p>
Here&rsquo;s a demonstration of a live visualization in action:
</p>


<div id="org916b985" class="figure">
<p><img src="./demo-live-visualization.gif" alt="demo-live-visualization.gif" />
</p>
<p><span class="figure-number">Figure 4: </span>Demonstration of enabling live visualization for a Function</p>
</div>

<p>
As you can see, the function does not have <code>Publish output</code> checked. Also notice how the script is
effectively paused, resumed and stopped.
</p>

<p>
In <a href="#org394e4de">this screenshot</a> you can see how the properties panel looks when you have clicked on an empty space
in the scene, which means you display the properties of the current script.
</p>


<div id="org394e4de" class="figure">
<p><img src="./properties-script.png" alt="properties-script.png" />
</p>
<p><span class="figure-number">Figure 5: </span>Properties panel for a script</p>
</div>

<p>
Here you can see:
</p>
<ul class="org-ul">
<li><code>Name</code>: this is the name of the script. You can change it by double-clicking on the tab just above
the scene.</li>
<li><code>Freq</code>: this shows at which frequency the whole script is run. <code>Kheops</code> scripts are <i>synchronous</i>
which means a wave of execution is propagated through the graph of Functions. Generally we write
scripts from left to right (as Function&rsquo;s inputs are situated on their left, and their output are
on their right). The Functions which have no inputs (Constants) begin executing, passing their
results to Functions with which they are linked, and so on. When the execution reaches the
Functions are the leaves, it stop until it&rsquo;s start to execute again, based on the frequency.</li>
<li><code>Unit</code>: some people prefer to set a script&rsquo;s execution <i>frequency</i> while others prefer to set the
<i>period</i>, this selector allows you to chose between the two (note that the value is computed for
you when you switch from one to another).</li>
<li><code>Crypted</code>: scripts are standard XML files. Thus they can be read easily by a human if need be. By
checking this box, <code>Papyrus</code> crypt the file when saving it, so that it&rsquo;s a binary, encrypted
format. Note that this is an <b>experimental</b> feature as is suffers from two problems:
<ol class="org-ol">
<li>while encrypting, <code>Papyrus</code> will first save the file to a temporary, plaintext XML file, and
<i>then</i> encrypt it (and deleting the plaintext XML file). This is not secure because it&rsquo;s fairly
easy to crawl the temporary files location to quickly get a copy of the script. We should
encrypt directly in memory with streams.</li>
<li>As for now, the only way to crypt and decrypt a file is to give <code>Papyrus</code> a location of a <code>key</code>
and <code>iv</code>. We initially developed this feature to be give people the ability to create a script
and encrypt it to be put on a robot so that the logic behind it is not accessible to everyone.
But the obvious problem remains where to store the keys. Several options were envisioned such
as giving <code>Papyrus</code> the ability to remote fetch a key from a server, store it in a secure
location inside the BIOS, or use a password at launch, etc. This was not a priority in the
development hence this feature is frozen for now. We will get back to it at a later time.</li>
<li>As of now, <code>Kheops</code> did not implement the ability to decrypt files, so they are pretty useless
for now.</li>
</ol></li>
</ul>

<p>
In <a href="#orgb6d29eb">this screenshot</a> you can see how the properties panel looks when you have a Link selected.
</p>


<div id="orgb6d29eb" class="figure">
<p><img src="./properties-link.png" alt="properties-link.png" />
</p>
<p><span class="figure-number">Figure 6: </span>Properties panel for a link</p>
</div>

<p>
A Link stores a matrix of weights between the output of a Function and the Input of another. There
are four types of Links (or Inputs for a Function, this is equivalent), they are:
</p>
<ul class="org-ul">
<li><code>SCALAR_SCALAR</code>: the Link stores a single scalar, and is between a Function that outputs a scalar,
and an input of type scalar.</li>
<li><code>SCALAR_MATRIX</code>: the Link stores a single scalar and is between a Function that outputs a matrix
and an input of type matrix. The scalar weight in the Link comes as a multiplier for the global
matrix.</li>
<li><code>MATRIX_MATRIX</code>: the Links stores a matrix of weights and is between a Function that outputs a
matrix and an input of type matrix. If output matrix has <code>N</code> neurons and the output matrix of the
Function whose Link is an input to is <code>M</code>, then the Link has <code>N*M</code> neurons in it (this can be a
lot). Basically every neurons from the originating matrix has a scalar weight with every neurons
of the target Function matrix. And those weight can be modified at each iterations (this is
basically how learning functions <i>learn</i>).
In such links, the weight you see above the link (which you are asked when you create the Link) is
the <i>initial value</i>.</li>
<li><code>STRING_INPUT</code>: this is just to store a string instead of a <i>weight</i>, and if only for special
Functions that have string parameters.</li>
</ul>

<p>
The checkbox <code>Secondary</code> is to be checked for Links that loop back to a previous Function. It informs
<code>Kheops</code> that this Link should be ignored on the very fist iteration (otherwise we have a
chicken-egg problem where Functions can&rsquo;t be triggered because they take for input the output of a
<i>later</i> function). When you create a self-looping Link, <i>i.e.</i> a Link that goes for the output of a
Function back to one of its own input, this checkbox is automatically checked for you, <b>but</b> if you
create a Link to a Function earlier in the graph, then it&rsquo;s your responsibility to check it (as
<code>Papyrus</code> doesn&rsquo;t (yet?) traverse the graph to find dependencies (MR are appreciated btw!)).
</p>

<p>
When the Link is of type <code>MATRIX_MATRIX</code> (and only in this case), you can set the <i>neighborhood</i> of
neurons. It means you can define how each neurons from the incoming Function will be connected to
each neurons in the target Function. There are three possibilities:
</p>
<ul class="org-ul">
<li><code>One to one</code>: in which case all neurons from the originating matrix are mapped to their
corresponding neuron in the target matrix (and only this neuron)</li>
<li><code>One to all</code>: in which case all neurons from the originating matrix are mapped to all neurons in
the target matrix</li>
<li><code>One to neighbors</code>: in which case you are free to define the mapping rule. As of now, <code>Kheops</code>
support a simple regex-like pseudo language to define the mapping. The definition of those regex
can be found <a href="https://github.com/instar-robotics/kheops/blob/master/README.md">in the <code>Kheops</code> documentation</a>. There are plans to support a better GUI tool within
<code>Papyrus</code> instead of manually entering the regexes, but in the meantime, you need to write them by
hand, one regex per line in the <code>Connectivity regexes</code> text field.</li>
</ul>
</div>
</div>

<div id="outline-container-org4bd0186" class="outline-4">
<h4 id="org4bd0186"><span class="section-number-4">3.2.4</span> 4. The scene</h4>
<div class="outline-text-4" id="text-3-2-4">
<p>
The scene is the main <code>Papyrus</code> area. It corresponds to the script you are writing. This is where
you drop Functions that were dragged from the library panel, and interconnect them with Links.
</p>

<p>
You can move a Function (or a group of Functions) by selecting them and dragging them across the
scene with your mouse.
</p>

<p>
You can delete a Function of a Link by selecting it and hitting your <code>&lt;DELETE&gt;</code> key.
</p>

<p>
<code>Papyrus</code> supports undo / redo (bound to <code>CTRL + Z</code> / <code>CTRL + Y</code>) for all major actions (adding a
Function to the scene, deleting a Function from the scene, changing a Function&rsquo;s properties, same
with Links, etc.).
</p>

<p>
Everything draw in the scene is vectorial, which means you can zoom in and out the scene as you wish
(either from the <code>View</code> menu, the toolbar buttons or <code>CTRL + mouse wheel</code>).
</p>

<p>
You&rsquo;ve got scroll bars to scroll the scene horizontally and vertically. Alternatively, using your
mouse wheel will scroll the scene vertically and <code>ALT + mouse wheel</code> will scroll the scene
horizontally.
</p>

<p>
At any time you can hit <code>CTRL + =</code> (or click <code>Zoom fit</code> from the toolbar) to re-center and re-zoom
the scene to contain all elements (this is useful when you get lost in a scroll or zoom).
</p>
</div>
</div>

<div id="outline-container-orge4b38de" class="outline-4">
<h4 id="orge4b38de"><span class="section-number-4">3.2.5</span> 5. The status bar</h4>
<div class="outline-text-4" id="text-3-2-5">
<p>
The bottom left corner of the window is the status bar (currently empty in <a href="#org9329bbe">the
main window</a>, but you can see some message in <a href="#org047ee1d">the first picture</a> or even see it in action
<a href="#org916b985">in the live demo</a>).
</p>

<p>
This status bar is used to display messages when something happens in <code>Papyrus</code>. You&rsquo;ve got three
kinds of messages:
</p>
<ul class="org-ul">
<li>Info messages, which are displayed in black confirms an action or an event you might be interested
in.</li>
<li>Warning messages, which are displayed in orange explain that some part of the action you&rsquo;ve just
tried to perform failed, but it&rsquo;s non fatal, and you can still continue to work.</li>
<li>Error messages, which are displayed in red explain that something you did triggered an error and
your action is not possible.</li>
</ul>
</div>
</div>

<div id="outline-container-orgb984214" class="outline-4">
<h4 id="orgb984214"><span class="section-number-4">3.2.6</span> 6. The ROS-master indicator</h4>
<div class="outline-text-4" id="text-3-2-6">
<p>
This ROS icon is just here as a convenience to tell you the current status of the ROS master. It&rsquo;s
green when the ROS master is detected up and running, and turns red when the ROS master goes down.
<code>Papyrus</code> still works when the ROS master is down, but it&rsquo;s an indicator that you won&rsquo;t be able to
launch/pause a script, or even connect to one, let alone live visualize some Functions, since the
ROS master is not running, those are either not running either, or not reachable.
</p>
</div>
</div>
</div>

<div id="outline-container-org5380a30" class="outline-3">
<h3 id="org5380a30"><span class="section-number-3">3.3</span> Manual</h3>
<div class="outline-text-3" id="text-3-3">
</div>
<div id="outline-container-org0bcf96f" class="outline-4">
<h4 id="org0bcf96f"><span class="section-number-4">3.3.1</span> Create a new script</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
You can create a new script by clicking <code>File &gt; New Script</code>, or clicking the <code>New Script</code> icon or
better, by hitting <code>CTRL + N</code>.
</p>

<p>
You are then greeted with a small modal window asking you the name of the new script, which will
also be its default filename. Chose your name wisely because whatever you put there will become part
of the topic names (<i>e.g.</i> if you set <code>foo</code>, then your ROS topics and services will be in the form
<code>/kheops_foo/xxx</code>).
</p>

<p>
You can cancel the creation of a new script by clicking <code>Cancel</code> or hitting <code>&lt;ESCAPE&gt;</code>.
</p>
</div>
</div>

<div id="outline-container-org41bd4ba" class="outline-4">
<h4 id="org41bd4ba"><span class="section-number-4">3.3.2</span> Open an existing script</h4>
<div class="outline-text-4" id="text-3-3-2">
<p>
You can open a script by clicking <code>File &gt; Open Script</code>, clicking on the <code>Open Script</code> icon. You&rsquo;ve
got a file selector which allows you to select <code>.xml</code> files. The new opened script will be added as
a new tab in the scene.
</p>
</div>
</div>

<div id="outline-container-orgcd1247c" class="outline-4">
<h4 id="orgcd1247c"><span class="section-number-4">3.3.3</span> Save current script</h4>
<div class="outline-text-4" id="text-3-3-3">
<p>
You can save the current script by clicking <code>File &gt; Save Script</code>, by clicking the <code>Save Script</code> icon
or better, hit <code>CTRL + S</code>. The first time you save a script, it will ask you the location in which
you want to save the script and it will pre-fill the file name, based on the Script name you defined
at the creation.
</p>

<p>
Script that were modified by not saved have a little star next to their name in the tabs.
</p>
</div>
</div>

<div id="outline-container-org0ade04e" class="outline-4">
<h4 id="org0ade04e"><span class="section-number-4">3.3.4</span> Close current script</h4>
<div class="outline-text-4" id="text-3-3-4">
<p>
You can close the current script by clicking <code>File &gt; Close Script</code> or better, by hitting <code>CTRL + W</code>.
If the file was modified, it will first ask you if you want to save it.
</p>
</div>
</div>

<div id="outline-container-org0c502e2" class="outline-4">
<h4 id="org0c502e2"><span class="section-number-4">3.3.5</span> Undo / redo actions</h4>
<div class="outline-text-4" id="text-3-3-5">
<p>
you can undo or redo last actions by clicking <code>Edit &gt; Undo / Redo</code> or better, hit <code>CTRL + Z</code>,
<code>CTRL + Y</code>.
</p>
</div>
</div>

<div id="outline-container-org15c22ed" class="outline-4">
<h4 id="org15c22ed"><span class="section-number-4">3.3.6</span> Reopen last opened scripts</h4>
<div class="outline-text-4" id="text-3-3-6">
<p>
If you want <code>Papyrus</code> to remember which scripts were opened when you closed it, you need to check
the option in <code>Options &gt; Reopen last scripts</code>.
</p>
</div>
</div>

<div id="outline-container-org2f85593" class="outline-4">
<h4 id="org2f85593"><span class="section-number-4">3.3.7</span> Zooming the scene</h4>
<div class="outline-text-4" id="text-3-3-7">
<p>
You can zoom in, out or zoom fit the scene in the menu <code>View &gt; Zoom in/out/fit</code>, or clicking the
corresponding icons on the tool bar, or better, by hitting <code>CTRL + +</code>, <code>CTRL + -</code> or <code>CTRL + =</code>.
</p>
</div>
</div>

<div id="outline-container-org10421e6" class="outline-4">
<h4 id="org10421e6"><span class="section-number-4">3.3.8</span> Antialiasing</h4>
<div class="outline-text-4" id="text-3-3-8">
<p>
You can toggle antialiasing in the menu <code>View &gt; Antialiasing</code> or better, by hitting <code>CTRL + SHIFT +
A</code>.
</p>
</div>
</div>

<div id="outline-container-orgf49690c" class="outline-4">
<h4 id="orgf49690c"><span class="section-number-4">3.3.9</span> Display the grid</h4>
<div class="outline-text-4" id="text-3-3-9">
<p>
You can toggle the display of the grid (the little dots on the scene) in the menu <code>View &gt; Display
Grid</code>, by clicking the corresponding toolbar button or better, hit <code>CTRL + SHIFT + G</code>. Note that the
grid always exists (and Functions will be snapped to the grid), it&rsquo;s just a matter of whether you
want to see it or not.
</p>
</div>
</div>

<div id="outline-container-org2d3aa7b" class="outline-4">
<h4 id="org2d3aa7b"><span class="section-number-4">3.3.10</span> Connect to a running <code>Kheops</code> script</h4>
<div class="outline-text-4" id="text-3-3-10">
<p>
You can connect <code>Papyrus</code> to a running <code>Kheops</code> script by clicking on <code>Kheops &gt; Connect</code>, the
<code>Connect to Kheops</code> toolbar button or better, hit <code>CTRL + C</code>. It will present you with a list of
detected running <code>Kheops</code> scripts (make sure your ROS URL is correct), click on the one you want and
it will connect.
</p>

<p>
For now, if you connect to a script that is running locally (on your machine), <code>Papyrus</code> will
automatically open the script file, so you can start debugging Functions live! (The remote version
is coming).
</p>
</div>
</div>

<div id="outline-container-org8fe8ab9" class="outline-4">
<h4 id="org8fe8ab9"><span class="section-number-4">3.3.11</span> Launch/pause/resume/stop a script</h4>
<div class="outline-text-4" id="text-3-3-11">
<p>
Whether you have connected to a script or if you are creating a script, you can launch it, pause it,
resume it or stop it with the <code>Kheops &gt; Run/Pause/Stop</code> menu or the corresponding toolbar icons.
Note that the lifecycle of the script is independent of <code>Papyrus</code>:
</p>
<ul class="org-ul">
<li>you can start a script with <code>Papyrus</code> and exit <code>Papyrus</code>, the script will still be running</li>
<li>you can connect to an already running script, and pause it / quit it from <code>Papyrus</code></li>
<li>if you are connected to a running script or if you have launched the script (from <code>Papyrus</code> or
not), you can pause/resume/stop the script with the command lines (through the associated ROS
service calls) and <code>Papyrus</code> will automatically reflect the new status in its interface.</li>
</ul>
<p>
Th idea is that you can administer your ROS nodes by the command line, or via <code>Papyrus</code>, and both at
the same time without an issue.
</p>
</div>
</div>

<div id="outline-container-org648d556" class="outline-4">
<h4 id="org648d556"><span class="section-number-4">3.3.12</span> Display a Function&rsquo;s activity</h4>
<div class="outline-text-4" id="text-3-3-12">
<p>
You can display a Function&rsquo;s activity (remember &ldquo;activity&rdquo; and &ldquo;output&rdquo; are the same thing) by
clicking on a Function in the scene, and clicking <code>Display Visualization</code> from the properties panel.
This will create a small graph window in which the activity of the Function is displayed.
</p>

<p>
You can enable the visualization before launching the node, or while the node is running, as you
wish: this works transparently!
</p>

<p>
You can move the activity visualizer window by drag and drop-ing it. You can change its size by
approaching your cursor to either the right edge, the bottom edge or the bottom right corner; the
cursor will change change, and at this point it&rsquo;s just a matter of clicking and dragging, this is
quite intuitive and standard.
</p>

<p>
You can close a Function&rsquo;s activity visualizer by selecting it (clicking on it) and hitting
<code>&lt;ESCAPE&gt;</code> or <code>&lt;DEL&gt;</code>.
</p>
</div>
</div>

<div id="outline-container-orga86efa1" class="outline-4">
<h4 id="orga86efa1"><span class="section-number-4">3.3.13</span> Hiding / showing all outputs</h4>
<div class="outline-text-4" id="text-3-3-13">
<p>
If you want to quickly <i>hide</i> (not close) all visible Activity visualizers, you can click <code>Kheops &gt;
Hide outputs</code>, or better hit <code>CTRL + H</code>. The widgets won&rsquo;t be computed anymore which makes you save
performances.
</p>

<p>
You can show them back with <code>Kheops -&gt; Show outputs</code> or hit <code>CTRL + SHIFT + H</code>.
</p>
</div>
</div>

<div id="outline-container-orga8c00e2" class="outline-4">
<h4 id="orga8c00e2"><span class="section-number-4">3.3.14</span> Listing shortcuts</h4>
<div class="outline-text-4" id="text-3-3-14">
<p>
You can have a list of shortcuts and a quick cheat sheet by clicking <code>Help &gt; List shortcuts</code>.
</p>
</div>
</div>

<div id="outline-container-org7aeccdc" class="outline-4">
<h4 id="org7aeccdc"><span class="section-number-4">3.3.15</span> See the CHANGELOG</h4>
<div class="outline-text-4" id="text-3-3-15">
<p>
You can see the <code>CHANGELOG</code> for the different versions of <code>Papyrus</code> by clicking <code>Help &gt; CHANGELOG</code>.
This lists all <code>Papyrus</code>- version, with the newest (the one you are running) at the top. Bug fixes
are listed, and new features are explicitly noted.
</p>

<p>
Note that the first time you open <code>Papyrus</code> after upgrading to a newer version this <code>CHANGELOG</code>
window will automatically appear once. Press <code>&lt;ESCAPE&gt;</code> to close it.
</p>

<p>
A <code>Papyrus</code> version corresponds to a <code>git tag</code> on the repository. A crawler automatically
periodically pings the repository for a new version. When it finds one, a pop-up will alert you that
a new <code>Papyrus</code> version has been released and that you can update.
</p>

<p>
This pop-up will only appear once, and <code>Papyrus</code> will never self-upgrade: you need to checkout the
sources yourself, build them (install <code>Papyrus</code> if you want) and re-launch for the upgrade to take
effect.
</p>
</div>
</div>

<div id="outline-container-orgb9ea93a" class="outline-4">
<h4 id="orgb9ea93a"><span class="section-number-4">3.3.16</span> See the About dialog</h4>
<div class="outline-text-4" id="text-3-3-16">
<p>
You can show the <code>About</code> dialog in <code>Help &gt; About Papyrus</code> or hit <code>CTRL + ?</code>.
</p>
</div>
</div>

<div id="outline-container-org00a47ce" class="outline-4">
<h4 id="org00a47ce"><span class="section-number-4">3.3.17</span> Creating a Link</h4>
<div class="outline-text-4" id="text-3-3-17">
<p>
In order to connect the output of a Function to the input of another, you need to create a Link. To
create a Link, simply click on the <i>Output slot</i> of a box and drag until you reach the desired
<i>Input slot</i> of another box.
</p>

<p>
<code>Papyrus</code> will prevent you from creating invalid Links (remember that <code>Kheops</code> is strongly typed).
When you start making a Link, all input slots names will be displayed so you know which input you
need to reach. When you reach a valid input slot, the Link will turn green, indicating you that the
Link you are creating is valid and turn red if it is invalid.
</p>

<p>
Additionally, input slots which can receive your Link will slightly grow and turn green as you
approach then, while invalid input slots for this Link will stay grayed out.
</p>

<p>
You can see the creation of a Link in action <a href="#org22d9c28">below</a>. You can see that I first start to create an
invalid Link (twice): the Link turns red and when I release my mouse, the link is not created. This
is because I&rsquo;m trying to link a <code>MATRIX</code> type Function to a <code>SCALAR</code> type input.
</p>

<p>
When I create a Link from the <code>SCALAR</code> constant Function, there it works. Immediately after
releasing the mouse, a small pop-up asks you for the weight you want to assign this Link. You can
change it later by selecting the Link and editing its Link in the properties panel.
</p>


<div id="org22d9c28" class="figure">
<p><img src="./demo-link.gif" alt="demo-link.gif" />
</p>
<p><span class="figure-number">Figure 7: </span>Demonstration of the creating of a Link</p>
</div>
</div>
</div>

<div id="outline-container-org27fc923" class="outline-4">
<h4 id="org27fc923"><span class="section-number-4">3.3.18</span> Inhibition Inputs</h4>
<div class="outline-text-4" id="text-3-3-18">
<p>
All Functions have an additional input, which is not described in its XML description file: the
inhibition input. It&rsquo;s called <code>inhib</code> and is of type <code>SCALAR</code>.
</p>

<p>
This input slot is situated near the output slot, and is almost invisible most of the time. It only
becomes visible when you are creating a new Link, and while you are dragging the Link, you need to
come close to it (remember: it&rsquo;s located near the output slot). When you have Links connected to
this inhibition input, it also becomes permanently visible.
</p>

<p>
The goal of this input is, as its name implies, to <i>inhibit</i> the activity of this Function. When no
Link are present on <code>inhib</code>, or if the value is <code>0</code>, then the activity of the Function is unchanged.
But when the Link on <code>inhib</code> takes values between <code>0</code> and <code>1</code>, the activity is linearly inhibited
correspondingly (<i>i.e.</i> multiplied by <code>1 - inhib</code>). So the closer you are to a value of <code>1</code>, the
closer the activity of this Function falls to <code>0</code>. This setup is there to mimic neural inhibition
where some Function can decrease the value of another when it fires.
</p>

<p>
For almost all purposes, you can see this <code>inhib</code> entry as a standard multiplication with <code>SMul</code> by
the value (only it&rsquo;s <code>1 - inhib</code>). With <b>one</b> difference: when <code>inhib</code> reaches <code>1.0</code>, the inhibited
Function actually <b>stops publishing its activity on the ROS bus</b> (contrary to a simple <code>SMul</code>).
</p>

<p>
You can see the <code>inhib</code> input in the <a href="#org219a963">video below</a>.
</p>


<div id="org219a963" class="figure">
<p><img src="./demoinhib.gif" alt="demoinhib.gif" />
</p>
<p><span class="figure-number">Figure 8: </span>The inhib input slot is situated near the output slot and is mostly invisible expected when approached</p>
</div>
</div>
</div>

<div id="outline-container-org5985a2d" class="outline-4">
<h4 id="org5985a2d"><span class="section-number-4">3.3.19</span> Swapping Functions</h4>
<div class="outline-text-4" id="text-3-3-19">
<p>
Sometimes when you are in the process of creating a script you want to test some new Functions in
place of another. For hits purpose, we implemented &ldquo;Function swapping&rdquo;: this is where you drag a
Function from the library panel, but instead of dropping it on an empty space in the scene, you drop
in <i>on top of another Function</i>.
</p>

<p>
When you do this, the Function on the scene will turn purple to indicate that if you drop here, it
will be swapped out. When you swap out Functions, several things happen:
</p>
<ul class="org-ul">
<li>the initial Function (the one that was already present on the scene) is removed</li>
<li>the new Function (the one you are dragging and just dropped) takes its place on the scene</li>
<li>every inputs whose names are common between the two Functions will keep their Links</li>
<li>if there were Links to input of the initial Function and if the new Function doesn&rsquo;t have an input
with the same name, then these Link will be deleted</li>
<li>the newly-dropped Function will keep <b>the same UUID</b>. This is important as the UUID is each
object&rsquo;s unique identifier, this is how <code>Kheops</code> identify Links, Functions, inputs, etc. and how
it internally maps Links. The fact that the newly dropped Function keeps the same UUID means you
are making minor modifications to your graph.</li>
<li>the newly-dropped Function will keep the same properties of the Function it replaced, namely:
<ul class="org-ul">
<li>the same topic name: so it will publish on the same topic, and if you had scripts of command
lines that were listening to it, you don&rsquo;t have to change anything</li>
<li>the same dimensions (if they are both <code>MATRIX</code> Functions)</li>
<li>the same checked states for <code>Publish output</code> and <code>Save activity</code></li>
<li>the same <code>Title</code>, etc.</li>
</ul></li>
</ul>

<p>
You can see the Function swap in action <a href="#orga60f4ef">below</a>. I start with a <code>SSum</code> Function which is a simply
addition of scalars. I am giving it a <code>Title</code>, I check the <code>Save activity</code> property and I show you
its topic name (which is based on its UUID since I did not enter anything specific).
</p>

<p>
Then I search for the <code>SMul</code> Function which is a simply multiplication of scalar (by the way you can
see how filtering for Functions in the library panel works), then I drag the <code>SMul</code> Function on the
scene. When I hover the <code>SSum</code> Function, it turns purple and when I drop it on it, I&rsquo;ve got a
confirmation pop-up asking me if I&rsquo;m sure.
</p>

<p>
When I confirm, you can see in the properties panel that indeed, the new Function has become <code>SMul</code>,
it kept the same <code>Title</code>, the same <code>Save activity</code> checked and the same topic.
</p>


<div id="orga60f4ef" class="figure">
<p><img src="./demo-swap.gif" alt="demo-swap.gif" />
</p>
<p><span class="figure-number">Figure 9: </span>Demonstration of the Function swap feature</p>
</div>

<p>
This is useful to try out different Functions without the hassle of recreating Links and not loosing
your graph&rsquo;s integrity.
</p>
</div>
</div>

<div id="outline-container-org262e3f2" class="outline-4">
<h4 id="org262e3f2"><span class="section-number-4">3.3.20</span> Creating comment zones</h4>
<div class="outline-text-4" id="text-3-3-20">
<p>
When your scripts become to have a good number of Functions and a Links, it might become a bit
difficult to remember what does what. In order to do this, you have the ability to create <code>Comment
Zones</code> or (<code>Zones</code>) by using your right mouse button and dragging a rectangle.
</p>

<p>
This create a sort of container in which you can put Functions. They have no meaning for <code>Kheops</code>
and won&rsquo;t change anything in the way the script is executed, this is a <code>Papyrus</code> feature only and is
intended to organize your code into groups of interest. You can also give a <code>Title</code> to a <code>Zone</code>,
which can act as a small comment.
</p>

<p>
When you move a <code>Zone</code>, it moves all Functions inside with it. When you delete a <code>Zone</code> though, it
will only delete the <code>Zone</code>, not the Functions inside.
</p>

<p>
You can see the creation of a <code>Zone</code> and how to add a small comment and change its color <a href="#org6f0e102">below</a>. As
you can see: once a Function is inside the Zone, it moves with it, but if you get it out, it is free
again.
</p>

<p>
Use <code>Zones</code> with colors to group your scripts in sensible, logical, meaningful sections.
</p>


<div id="org6f0e102" class="figure">
<p><img src="./demo-zone.gif" alt="demo-zone.gif" />
</p>
<p><span class="figure-number">Figure 10: </span>Demonstration of the creation of basic features of a <code>Zone</code></p>
</div>
</div>
</div>

<div id="outline-container-org9df38ce" class="outline-4">
<h4 id="org9df38ce"><span class="section-number-4">3.3.21</span> Color code for types</h4>
<div class="outline-text-4" id="text-3-3-21">
<p>
To help you quickly identify which slots can be linked together, there is a basic color coding for
the type of slots (both inputs and output). As you can see <a href="#orgc04c817">in this picture</a> :
</p>
<ul class="org-ul">
<li><code>SCALAR</code> types are white</li>
<li><code>STRING</code> types are cyan</li>
<li><code>MATRIX</code> type are pink</li>
</ul>


<div id="orgc04c817" class="figure">
<p><img src="./color-types.png" alt="color-types.png" />
</p>
<p><span class="figure-number">Figure 11: </span>Illustration of the three colors for the three types</p>
</div>

<p>
Additionally, <code>MATRIX</code> Functions also have their background pink and =SCALAR+ Functions have their
background white in the library panel.
</p>
</div>
</div>

<div id="outline-container-org9364b89" class="outline-4">
<h4 id="org9364b89"><span class="section-number-4">3.3.22</span> Seeing the input names</h4>
<div class="outline-text-4" id="text-3-3-22">
<p>
the moment you start creating a Link from a Function in the scene, all input slots&rsquo;s name will
appear for the Functions on the scene, which helps you select the right one. When you finish the
creation of you Link, the slots&rsquo; name will disappear.
</p>

<p>
Some people prefer to see the slots name at all times, it is possible to have them displayed by
pressing <code>&lt;T&gt;</code> on the scene.
</p>

<p>
You can see it in action <a href="#orge0e4237">below</a>. When I press <code>&lt;T&gt;</code> the names appear and stay on, when I press <code>&lt;T&gt;</code>
again they disappear.
</p>


<div id="orge0e4237" class="figure">
<p><img src="./demo-toggle.gif" alt="demo-toggle.gif" />
</p>
<p><span class="figure-number">Figure 12: </span>Input slots names can be toggled on and off by pressing <code>&lt;T&gt;</code></p>
</div>
</div>
</div>

<div id="outline-container-orge9ed123" class="outline-4">
<h4 id="orge9ed123"><span class="section-number-4">3.3.23</span> Icon reflects type and matrix size</h4>
<div class="outline-text-4" id="text-3-3-23">
<p>
In order to quickly get a sense of what Functions outputs (whether it&rsquo;s a scalar, or a matrix and
when it&rsquo;s a matrix what rough shape it has) there&rsquo;s an icon on the right part of a Function that
reflects the Function&rsquo;s output.
</p>

<p>
In <a href="#org1828a1c">this picture</a> you can see :
</p>
<ul class="org-ul">
<li>The <code>SSUM</code> Function is <code>SCALAR</code>: it has a small &ldquo;dot&rdquo; neuron of its right part</li>
<li>The <code>LMS</code> Function is a matrix with <code>N</code> rows and <code>M</code> columns: it has a small matrix of neurons
drawn on it.</li>
<li>The <code>MSum</code> Function is a <code>MATRIX</code> with only <code>1</code> column, this is effectively a column vector so it
has the icon of a little vertical vector.</li>
<li>The <code>MSSum</code> Function is a <code>MATRIX</code> with only <code>1</code> row, this is effectively a row vector to is has
the icon of a little horizontal vector.</li>
</ul>

<p>
Note that this is dynamic: if you change the number of rows and columns of a <code>MATRIX</code>, the icon will
adapt. This is only decorative and aims at helping you quickly identify Functions, it has no meaning
for <code>Kheops</code>.
</p>


<div id="org1828a1c" class="figure">
<p><img src="./shapes.png" alt="shapes.png" />
</p>
<p><span class="figure-number">Figure 13: </span>The three different icon indicators for the Functions output</p>
</div>
</div>
</div>


<div id="outline-container-orgfbe5a88" class="outline-4">
<h4 id="orgfbe5a88"><span class="section-number-4">3.3.24</span> Name conventions</h4>
<div class="outline-text-4" id="text-3-3-24">
<p>
Since we made the choice to have a strongly typed system, we needed to identify Functions. For
instance we could not simply have a <code>Sum</code> or <code>+</code> Function:
</p>
<ul class="org-ul">
<li>We need to be able to add two (or more) scalars together</li>
<li>We need to be able to add a scalar to a matrix (the scalar gets added to every value in the
matrix, effectively being an offset)</li>
<li>We need to able to add two (or more) matrices together</li>
</ul>

<p>
With our strongly typed system, those need to be separate Functions, all of which can legitimately
be called &ldquo;Sum&rdquo;.
</p>

<p>
We came to a naming system where &ldquo;S&rdquo; stands for &ldquo;scalar&rdquo; and &ldquo;M&rdquo; for &ldquo;matrix&rdquo;. And those three
functions above are named respectively:
</p>
<ul class="org-ul">
<li><code>SSum</code> for &ldquo;Scalar sum&rdquo;</li>
<li><code>MSSum</code> for &ldquo;Matrix Scalar sum&rdquo;</li>
<li><code>MSum</code> for &ldquo;Matrix sum&rdquo;</li>
</ul>

<p>
This sure makes for some weird Function names, but this was a compromised between readability,
explicitness, and length. After a few days of tinkering with <code>Papyrus</code> you get used to it.
</p>
</div>
</div>

<div id="outline-container-orgdb85d29" class="outline-4">
<h4 id="orgdb85d29"><span class="section-number-4">3.3.25</span> Function documentation</h4>
<div class="outline-text-4" id="text-3-3-25">
<p>
In order to have some information about what a Function does, and what its inputs are, you can hover
the mouse of its name in the library panel and a tooltip will appear with the information the
developer wrote in the XML description file.
</p>

<p>
See it in action <a href="#org9f56a88">here</a>:
</p>


<div id="org9f56a88" class="figure">
<p><img src="./demo-tooltip.gif" alt="demo-tooltip.gif" />
</p>
<p><span class="figure-number">Figure 14: </span>Functions in the library panel show their documentation</p>
</div>

<p>
If some information is missing, wrong or unclear, please make an issue
<a href="https://github.com/instar-robotics/alexandria/issues">in <code>Alexandria</code></a>, not in <code>Papyrus</code> as this is where the information is stored.
</p>
</div>
</div>

<div id="outline-container-org94c04c5" class="outline-4">
<h4 id="org94c04c5"><span class="section-number-4">3.3.26</span> Error indicators</h4>
<div class="outline-text-4" id="text-3-3-26">
<p>
<code>Papyrus</code> tries its best to warn you when you make mistakes. For instance, when a Link is invalid,
it turns red and if you hover your mouse on it, a tooltip will explain the cause of the error.
</p>

<p>
In <a href="#org7607eac">this gif</a> you see I am creating a Matrix which is not a vector, so it complains (because there&rsquo;s a
requirement in the input for its incoming Matrix to be a vector). When I hover the link, it tells me
what the problem is, I fix it, and the Link turns back normal blue.
</p>


<div id="org7607eac" class="figure">
<p><img src="./demo-faillink.gif" alt="demo-faillink.gif" />
</p>
<p><span class="figure-number">Figure 15: </span><code>Papyrus</code> warns you about invalid Links</p>
</div>
</div>
</div>
<div id="outline-container-orgf2ee239" class="outline-4">
<h4 id="orgf2ee239"><span class="section-number-4">3.3.27</span> Commenting / uncommenting Functions</h4>
<div class="outline-text-4" id="text-3-3-27">
<p>
The same way you can comment a line or a portion of code in a traditional programming language,
Papyrus allows you to comment one or several Functions. In order to comment / uncomment Functions,
you need to select them and press <code>C</code>. This will toggle the commented state of the selected
Functions, as such:
</p>
<ul class="org-ul">
<li>If you have selected only one Function, its commented state will be toggled.</li>
<li>If you have selected several Functions, then:
<ul class="org-ul">
<li>If they are all in the same commented state, they will be toggled.</li>
<li>Otherwise, they will all be commented, at which point additional presses will toggle them.</li>
</ul></li>
</ul>

<p>
When a Function is commented, several things happen:
</p>
<ul class="org-ul">
<li>it will be displayed as grayed out in Papyrus, with a red cross across it</li>
<li>all its connected links will also be displayed grayed out</li>
<li>you won&rsquo;t be able to create links from it, nor to it</li>
<li>when you launch the script, Kheops will &ldquo;ignore&rdquo; this Function by setting its activity to 0 and
stop this Function from publishing its output (it means the Functions after this one will receive
an activity with value 0, keep this in mind when commenting Functions).</li>
<li>if the <code>Live Comment</code> feature is enabled, and your script is running when you press <code>C</code>, then the
selected Functions will also be instantaneously commented or uncommented in the running script.</li>
</ul>

<p>
Note that you cannot comment Constants.
</p>

<p>
You can see commenting and uncommenting Functions in action <a href="#org294688d">in the video below</a>, and <a href="#orgaea4a6c">in this one</a>, you
can see the live comment feature (note how the activity of the function changes).
</p>


<div id="org294688d" class="figure">
<p><img src="./demo-comment.gif" alt="demo-comment.gif" />
</p>
<p><span class="figure-number">Figure 16: </span>Commenting and uncommenting Functions</p>
</div>


<div id="orgaea4a6c" class="figure">
<p><img src="./demo-live-comment.gif" alt="demo-live-comment.gif" />
</p>
<p><span class="figure-number">Figure 17: </span>Live comment feature in action: commenting/uncommenting a Function also requests the kheops node to comment/uncomment the Function</p>
</div>
</div>
</div>
<div id="outline-container-org1dc2163" class="outline-4">
<h4 id="org1dc2163"><span class="section-number-4">3.3.28</span> Copying / Pasting Functions</h4>
<div class="outline-text-4" id="text-3-3-28">
<p>
It is now possible to copy a group of Function on the scene and paste them on another place. This is
sometimes cumbersome to go fetch the Functions one by one again from the panel.
</p>

<p>
To use the copy/paste feature:
</p>
<ul class="org-ul">
<li>Select one or more Functions</li>
<li>Either click <code>Edit &gt; Copy</code> or use the <code>CTRL + C</code> shortcut: at this point, a copy of all selected
Functions will follow your mouse on the scene</li>
<li>If you press <code>ESCAPE</code> it will cancel the copy</li>
<li>To validate your copy and effectively paste your Functions on the scene, you just have to left
click.</li>
<li>The copy/paste feature support undo/redo: you can cancel your copy with <code>CTRL + Z</code> and redo it
with <code>CTRL + Y</code>.</li>
</ul>

<p>
<a href="#org8602499">Below</a> you can see it in action: I first copy a group of Function from the <code>Edit</code> menu, then I make
another copy with <code>CTRL + C</code>. At the end I undo/redo the operation a couple of times.
</p>


<div id="org8602499" class="figure">
<p><img src="./demo-copy.gif" alt="demo-copy.gif" />
</p>
<p><span class="figure-number">Figure 18: </span>Copying and pasting Functions</p>
</div>

<p>
Note that at the moment, only (non-constant) Functions can be copied: links and zones will be
ignored from the selection.
</p>
</div>
</div>
</div>
</div>



<div id="outline-container-orgebeb4f8" class="outline-2">
<h2 id="orgebeb4f8"><span class="section-number-2">4</span> Troubleshooting</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-orge0e2517" class="outline-3">
<h3 id="orge0e2517"><span class="section-number-3">4.1</span> Network Setup</h3>
<div class="outline-text-3" id="text-4-1">
<p>
If you encounter network issues with papyrus (typically no synchronisation), it may be due to your network configuration.
Please be sure to follow the steps described here:
<a href="https://wiki.ros.org/ROS/NetworkSetup">https://wiki.ros.org/ROS/NetworkSetup</a>
</p>
</div>
</div>
</div>
</div>
</body>
</html>
